(spark_env) mqang@mqang-legion-5-16ach6:~/Desktop/hadoop-3.2.1$ spark-submit --master yarn --deploy-mode client testchess.py
==================== Calculating Initial Chess Data Statistics ====================

Transaction Utility (TU) Statistics for Chess (from data):
  summary                 TU
0   count             236504
1    mean   674.799436795995
2  stddev  79.22011770151485
3     min              417.0
4     max             1019.0
==================== Finished Initial Chess Data Statistics ====================

==================== Starting HUOMIL Application (Chess) ====================
25/06/26 23:15:46 WARN Client: Neither spark.yarn.jars nor spark.yarn.archive is set, falling back to uploading libraries under SPARK_HOME.
HUOMIL running with Application ID: application_1750951271822_0020
HUOMIL Transactions: 3196

====== HUOMIL: VALID ITEMS in UOList ======
+---------+---------+-----+------------------+
|StockCode|InvoiceNo|   TU|                IU|
+---------+---------+-----+------------------+
|       19|        2|607.0| 5.602931748541961|
|       60|        2|607.0|5.4748201850869265|
|       64|        5|771.0|5.5736670193629685|
|       54|       10|602.0|10.944371174857821|
|        3|       12|565.0|27.486370007601405|
|       11|       29|713.0|10.975174642049366|
|       11|       30|571.0|10.975174642049366|
|       50|       32|725.0| 5.521369433812312|
|       20|       33|595.0|11.115120647140166|
|        7|       35|632.0|16.460764185517426|
|       48|       50|630.0|5.4995840195526675|
|       52|       52|632.0| 5.500349349394201|
|       42|       66|700.0| 5.464050580135169|
|        6|       68|638.0| 5.535036778739055|
|       50|       73|749.0| 5.521369433812312|
|        1|       84|655.0| 10.97466403742218|
|       54|       92|590.0|10.944371174857821|
|       64|       95|657.0|5.5736670193629685|
|       23|       99|647.0|    5.403247312691|
|       38|      103|805.0|   5.4891498805316|
+---------+---------+-----+------------------+
only showing top 20 rows


====== HUOMIL: 1-ITEMSETS ======
+---------+------------------+--------------------+
|StockCode|        total_util|              avg_uo|
+---------+------------------+--------------------+
|        7| 39900.89238569424| 0.01908074492552924|
|       51|  6681.30026281802| 0.00832151269790569|
|       15|25717.162989014843|0.014388218516289169|
|       54| 17193.60711570164|0.010427322707962086|
|       11|13461.051698473551|0.009095639436682812|
|       29| 17451.51646561156|0.008243441628165095|
|       69| 6582.949357734137| 0.00810703565243863|
|       42|23222.214965574465|0.011997796784047828|
|       73|  4619.71286689029|0.008498727359701929|
|       64|15723.314661622946|0.008798545279753945|
|        3| 45913.23246069737|0.022189905990304647|
|       30|19902.709799077424|0.013453286627361326|
|       34|16644.993008721725|0.008224891916552683|
|        8| 39974.79624404544| 0.02099970079356745|
|       28| 20497.03750147346|0.013463667213973574|
|       22| 7446.524284586946|0.009353234439772335|
|       52| 17518.61267782051|0.008264156325465897|
|       16|26601.757880530575|0.015741058982541654|
|       35| 8480.803586677968|0.010222961761662267|
|       71| 6617.902074433644|0.008248845466978554|
+---------+------------------+--------------------+
only showing top 20 rows


HUOMIL 2-itemset candidates: 3635378

====== HUOMIL: 2-ITEMSETS (Sorted by total_util) ======
+-----+-----+-----------------+--------------------+-------+
|item1|item2|total_util       |avg_uo              |itemset|
+-----+-----+-----------------+--------------------+-------+
|3    |9    |90436.07053774147|0.044432395895159814|3,9    |
|6    |9    |87953.45096046338|0.04501845674203352 |6,9    |
|3    |6    |87224.28123702171|0.044804556689766704|3,6    |
|7    |9    |85168.2842381606 |0.04143268538834908 |7,9    |
|5    |9    |84921.42645226874|0.04166464503753187 |5,9    |
|3    |7    |84474.42570182365|0.041259019361459356|3,7    |
|3    |5    |84233.29309007079|0.04153922570908881 |3,5    |
|12   |9    |83926.47064379178|0.043931835386221696|12,9   |
|4    |9    |83351.84073778988|0.04385491536989976 |4,9    |
|12   |3    |83074.09938663123|0.04371288885523865 |12,3   |
|3    |4    |82320.5683470387 |0.04354088812336748 |3,4    |
|6    |7    |82015.87351062337|0.04172677028752325 |6,7    |
|5    |6    |81528.12017999282|0.041947415020887224|5,6    |
|8    |9    |80967.15070905685|0.043213471836100026|8,9    |
|12   |6    |80516.03085375727|0.044068223746809736|12,6   |
|4    |6    |80444.8923108564 |0.044268159774399414|4,6    |
|3    |8    |80126.91667991488|0.04303262216261512 |3,8    |
|5    |7    |78624.30592811879|0.038428204713632404|5,7    |
|40   |9    |78609.56601001341|0.0376173561146915  |40,9   |
|36   |9    |78158.71132397933|0.037747248483498086|36,9   |
+-----+-----+-----------------+--------------------+-------+
only showing top 20 rows

==================== Finished HUOMIL Application ====================

==================== Starting HUOPM Application (Chess) ====================
25/06/26 23:16:28 WARN Client: Neither spark.yarn.jars nor spark.yarn.archive is set, falling back to uploading libraries under SPARK_HOME.
HUOPM running with Application ID: application_1750951271822_0021
HUOPM Transactions: 3196

====== HUOPM: 1-ITEMSETS ======
+---------+------------------+--------------------+
|StockCode|        total_util|              avg_uo|
+---------+------------------+--------------------+
|        7|39900.892385694184|0.019056800011934966|
|       51| 6681.300262818022|0.008309571667676654|
|       54| 17193.60711570164|0.010421765215328714|
|       15|25717.162989014905| 0.01440478011850924|
|       11|13461.051698473513|0.009091547650620079|
|       29|17451.516465611556|  0.0082432319325387|
|       69|  6582.94935773413|0.008102729539177239|
|       42|23222.214965574498|0.011981343735241607|
|       73| 4619.712866890297|0.008498435495725246|
|       64| 15723.31466162295|0.008807429903942992|
|        3|45913.232460697356|0.022214798044516936|
|       30|19902.709799077395|0.013452115096301443|
|       34|16644.993008721704|0.008216585391365843|
|        8| 39974.79624404543|0.020993005391429502|
|       28| 20497.03750147344|0.013490968262551596|
|       22| 7446.524284586956|0.009356456589906461|
|       52|17518.612677820485| 0.00825814942963963|
|       16|26601.757880530524| 0.01572077668730756|
|       35| 8480.803586677961|0.010236340909494039|
|       71| 6617.902074433653| 0.00823445321231963|
+---------+------------------+--------------------+
only showing top 20 rows


HUOPM 2-itemset candidates: 3635378

====== HUOPM: 2-ITEMSETS (Sorted by total_util) ======
+-----+-----+-----------------+--------------------+-------+
|item1|item2|total_util       |avg_uo              |itemset|
+-----+-----+-----------------+--------------------+-------+
|3    |9    |90465.91788309014|0.04445670451715186 |3,9    |
|6    |9    |87921.52495049282|0.04498396869072166 |6,9    |
|3    |6    |87146.75344367906|0.04479329154627527 |3,6    |
|7    |9    |85140.2864830609 |0.04137858641671057 |7,9    |
|5    |9    |84905.34041788972|0.04164602477058772 |5,9    |
|3    |7    |84454.86885551976|0.0412530132806342  |3,7    |
|3    |5    |84225.4709086259 |0.04156869067522538 |3,5    |
|12   |9    |84018.05881263038|0.043951731803479804|12,9   |
|4    |9    |83410.24040342023|0.04384962560121583 |4,9    |
|12   |3    |83021.60414214116|0.0437129684212342  |12,3   |
|3    |4    |82426.1109918634 |0.04360176473858752 |3,4    |
|6    |7    |82000.8024809511 |0.04169416506926559 |6,7    |
|5    |6    |81471.94199810461|0.04193019968680608 |5,6    |
|8    |9    |80929.30547668687|0.04317498503945602 |8,9    |
|12   |6    |80560.84229300552|0.04408152457269548 |12,6   |
|4    |6    |80416.50731452112|0.04424185560129559 |4,6    |
|3    |8    |80174.1471716674 |0.043077491304875516|3,8    |
|40   |9    |78655.96313850381|0.037606993177441345|40,9   |
|5    |7    |78605.2508128281 |0.03840291011908309 |5,7    |
|36   |9    |78095.62627876933|0.037727242376750326|36,9   |
+-----+-----+-----------------+--------------------+-------+
only showing top 20 rows

==================== Finished HUOPM Application ====================

Waiting 60 seconds for History Server...
--- Fetching metrics for App ID: application_1750951271822_0020 ---
Successfully fetched metrics for app application_1750951271822_0020.
--- Fetching metrics for App ID: application_1750951271822_0021 ---
Successfully fetched metrics for app application_1750951271822_0021.


==================== FINAL CHESS COMPARISON ====================
Jaccard Similarity between 2-itemsets: 0.9989

  Algorithm  1-itemsets  2-itemsets  Execution Time (s)  Driver CPU (s)  Driver Memory (MB)  Max Executor Memory (MB)  Shuffle Read (MB)
0    HUOMIL          75        2673           29.539471            0.12           95.078125                719.131081          43.699081
1     HUOPM          75        2674           26.834169            0.11           95.085938                769.131859          44.562825

Biểu đồ đã được lưu thành công vào file: chess_performance_comparison.png

