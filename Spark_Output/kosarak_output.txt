(spark_env) mqang@mqang-legion-5-16ach6:~/Desktop/hadoop-3.2.1$ spark-submit --master yarn --deploy-mode client testko.py
==================== Calculating Initial Kosarak Data Statistics ====================

Transaction Utility (TU) Statistics for Kosarak:
  summary                  TU
0   count              505217
1    mean  13.491744221070066
2  stddev   7.862356980501867
3     min  1.0000057882911815
4     max  47.489430940289566
==================== Finished Initial Kosarak Data Statistics ====================

==================== Starting HUOMIL Application (Kosarak) ====================
25/06/26 22:41:43 WARN Client: Neither spark.yarn.jars nor spark.yarn.archive is set, falling back to uploading libraries under SPARK_HOME.
HUOMIL running with Application ID: application_1750951271822_0008
HUOMIL Transactions with TU >= 15: 505217

====== HUOMIL: VALID ITEMS in UOList ======
+---------+---------+------------------+------------------+
|StockCode|InvoiceNo|                TU|                IU|
+---------+---------+------------------+------------------+
|        3|       26|21.931973206412323| 5.501690641180084|
|      582|       26|21.931973206412323|  5.43943260541087|
|        4|       26|21.931973206412323| 5.505371078225324|
|        6|       26|21.931973206412323| 5.485478881596045|
|       11|       29| 27.47429433712893| 5.499409008540086|
|        3|       29| 27.47429433712893| 5.501690641180084|
|      490|       29| 27.47429433712893|5.4873424428455495|
|        6|       29| 27.47429433712893| 5.485478881596045|
|       55|       29| 27.47429433712893| 5.500373362967166|
|        3|      474|16.666787693560885| 5.501690641180084|
|     2448|      474|16.666787693560885| 5.679618170784755|
|        6|      474|16.666787693560885| 5.485478881596045|
|        6|      964| 5.485478881596045| 5.485478881596045|
|       11|     1677| 22.01026960801944| 5.499409008540086|
|        3|     1677| 22.01026960801944| 5.501690641180084|
|      573|     1677| 22.01026960801944| 5.523691076703224|
|        6|     1677| 22.01026960801944| 5.485478881596045|
|        3|     1697| 10.96366672158468| 5.501690641180084|
|     1017|     1697| 10.96366672158468| 5.461976080404595|
|        3|     1806|10.972403039476657| 5.501690641180084|
+---------+---------+------------------+------------------+
only showing top 20 rows


====== HUOMIL: 1-ITEMSETS ======
+---------+------------------+-------------------+
|StockCode|        total_util|             avg_uo|
+---------+------------------+-------------------+
|     2136| 398.6949406076492| 0.3663972503793934|
|      467| 2262.629146324449| 0.3818006879429349|
|      296| 1186.135178048992| 0.3476189916638785|
|      944| 525.1805203718011| 0.3897933793218723|
|     3826| 5494.356178932025| 0.4174887995445542|
|     5657|183.28323599118912|0.36440193371412527|
|    17438| 340.4221182297738|0.44983310774830054|
|    10784|  155.839339339337| 0.4381649661020162|
|     5044| 258.3390428385806|0.34560654084759673|
|      666| 1976.297648486042| 0.3830074626610384|
|        7| 76866.86888865683|0.36998801708659457|
|     2895|  5229.28634107477| 0.4130355760753334|
|       51|419.10254470917164| 0.3754730952144265|
|     1528|246.77393023773516|  0.392660208003418|
|     1897| 204.8462903628578| 0.4173596419964118|
|      475|326.65399079340335| 0.4247200904360159|
|      307|2148.8961575187263|  0.352645947483274|
|      574| 889.1076379558434| 0.4171337327115474|
|     1773|170.03687568510492| 0.4881109594902507|
|     3553|2046.9189804312412| 0.3130392592089385|
+---------+------------------+-------------------+
only showing top 20 rows

==============================

HUOMIL 2-itemset candidates: 1280751

====== HUOMIL: 2-ITEMSETS (Sorted by total_util) ======
+-----+-----+------------------+------------------+-------+
|item1|item2|total_util        |avg_uo            |itemset|
+-----+-----+------------------+------------------+-------+
|3    |6    |1135095.4705681198|0.6390680738541784|3,6    |
|11   |6    |982993.6777357867 |0.5976152581430113|11,6   |
|11   |3    |504686.44753070903|0.5628674110397538|11,3   |
|1    |6    |380741.18038515677|0.6015853439375295|1,6    |
|1    |3    |335808.35618647357|0.6343132553195593|1,3    |
|4    |6    |185734.3734710472 |0.5971840421348148|4,6    |
|3    |4    |178655.61876765755|0.627643635528079 |3,4    |
|1    |11   |169451.43507584196|0.5370068375139939|1,11   |
|55   |6    |146386.48115881026|0.5932783065996833|55,6   |
|3    |55   |142938.81554188454|0.6272111116918904|3,55   |
|6    |7    |79603.46872222825 |0.5527570302096244|6,7    |
|2    |6    |78494.84296094885 |0.5848241220063256|2,6    |
|218  |6    |78000.63358917808 |0.5539410582741264|218,6  |
|11   |4    |77825.80477360697 |0.5344008359828513|11,4   |
|294  |6    |75757.80303252612 |0.5918425921836129|294,6  |
|294  |3    |74681.0097192342  |0.6197152457199718|294,3  |
|2    |3    |72598.33946663584 |0.6203965614479894|2,3    |
|11   |55   |62610.761258615756|0.53315207369548  |11,55  |
|3    |7    |59540.36078983091 |0.5872098531652825|3,7    |
|27   |6    |57522.635790731845|0.5754148650938025|27,6   |
+-----+-----+------------------+------------------+-------+
only showing top 20 rows

==================================================
==================== Finished HUOMIL Application ====================

==================== Starting HUOPM Application (Kosarak) ====================
25/06/26 22:42:56 WARN Client: Neither spark.yarn.jars nor spark.yarn.archive is set, falling back to uploading libraries under SPARK_HOME.
HUOPM running with Application ID: application_1750951271822_0009
HUOPM Transactions with TU >= 15: 505217

====== HUOPM: 1-ITEMSETS ======
+---------+------------------+-------------------+
|StockCode|        total_util|             avg_uo|
+---------+------------------+-------------------+
|     3210| 388.8982649899052|  0.411385857722703|
|     2162|264.13706270002785|  0.331423776847101|
|      467|2262.6291463244497| 0.3787651067786608|
|     3826| 5494.356178932014| 0.4192889411934988|
|      944| 525.1805203718014|0.38073262508387806|
|     3517| 735.1373365556086| 0.3861021361867171|
|    10784|155.83933933933696|0.42983085160579704|
|      666|1976.2976484860383| 0.3873468707057414|
|        7| 76866.86888865667|0.37019504323536634|
|     4988|506.04475161209103|  0.322186706662385|
|     2895| 5229.286341074772|0.41370895540761204|
|      591|189.31584131277904| 0.3910815923704867|
|     6768|142.12974056079895|0.36555322039720145|
|       51|419.10254470917147| 0.3616915137477083|
|      574| 889.1076379558423|  0.413817573940208|
|      747| 1995.188601485406| 0.3607289670786696|
|      205|6508.1278277654455| 0.3538615636869528|
|     3875| 764.1073953549649|0.39499819217089105|
|     4315| 5170.652579774347|  0.409867774860205|
|      711|250.45410897084224|0.46375917705081837|
+---------+------------------+-------------------+
only showing top 20 rows

==============================

HUOPM 2-itemset candidates: 1280751

====== HUOPM: 2-ITEMSETS (Sorted by total_util) ======
+-----+-----+------------------+------------------+-------+
|item1|item2|total_util        |avg_uo            |itemset|
+-----+-----+------------------+------------------+-------+
|3    |6    |1134777.0900012637|0.639102361065099 |3,6    |
|11   |6    |982157.0637486725 |0.5971562170603497|11,6   |
|11   |3    |504423.4988431429 |0.562760885862504 |11,3   |
|1    |6    |381483.17247934197|0.6019221191267795|1,6    |
|1    |3    |335240.8801017206 |0.6329361282003029|1,3    |
|4    |6    |185537.59578665846|0.5968700816148438|4,6    |
|3    |4    |178836.06154772482|0.6273565713348254|3,4    |
|1    |11   |170211.77532814152|0.5380823663172465|1,11   |
|55   |6    |146079.3717608937 |0.5931127170241244|55,6   |
|3    |55   |143110.73127469502|0.627792886791609 |3,55   |
|6    |7    |79635.87688740769 |0.5529502565384319|6,7    |
|2    |6    |78633.0553275464  |0.5855777620832414|2,6    |
|11   |4    |78350.65023001262 |0.5359693985931256|11,4   |
|218  |6    |78079.77852663756 |0.5543050568286872|218,6  |
|294  |6    |75883.48150958012 |0.5938967038627289|294,6  |
|294  |3    |74143.46957548    |0.6191828197154892|294,3  |
|2    |3    |72120.3230323821  |0.6195621361046818|2,3    |
|11   |55   |62143.33157559045 |0.5334380099611323|11,55  |
|3    |7    |59640.02926573102 |0.587933927977647 |3,7    |
|27   |6    |57428.649251047944|0.5750622923319751|27,6   |
+-----+-----+------------------+------------------+-------+
only showing top 20 rows

==================================================
==================== Finished HUOPM Application ====================

Waiting 60 seconds for History Server...
--- Fetching metrics for App ID: application_1750951271822_0008 ---
Found 2 non-driver executors. Analyzing peak memory.
Successfully fetched metrics for app application_1750951271822_0008. Max executor memory: 859.49 MB
--- Fetching metrics for App ID: application_1750951271822_0009 ---
Found 2 non-driver executors. Analyzing peak memory.
Successfully fetched metrics for app application_1750951271822_0009. Max executor memory: 773.68 MB


==================== FINAL KOSARAK COMPARISON ====================
Jaccard Similarity between 2-itemsets: 0.7442

  Algorithm  1-itemsets  2-itemsets  Execution Time (s)  Driver CPU (s)  Driver Memory (MB)  Max Executor Memory (MB)  Shuffle Read (MB)
0    HUOMIL        2605       38272           60.119573            1.15          106.031250                859.489044         230.738620
1     HUOPM        2605       48596           54.426099            1.37          113.421875                773.679245         231.484207

Biểu đồ đã được lưu thành công vào file: kosarak_performance_comparison.png

