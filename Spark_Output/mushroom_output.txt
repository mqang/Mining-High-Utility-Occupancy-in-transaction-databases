(spark_env) mqang@mqang-legion-5-16ach6:~/Desktop/hadoop-3.2.1$ spark-submit --master yarn --deploy-mode client test.py
==================== Calculating Initial mushroom Data Statistics ====================

Transaction Utility (TU) Statistics for mushroom (from data):
  summary                 TU
0   count             373704
1    mean  420.2018709995076
2  stddev  71.73678122822128
3     min              212.0
4     max              757.0
==================== Finished Initial mushroom Data Statistics ====================

==================== Starting HUOMIL Application (mushroom) ====================
25/06/27 18:37:11 WARN Client: Neither spark.yarn.jars nor spark.yarn.archive is set, falling back to uploading libraries under SPARK_HOME.
HUOMIL running with Application ID: application_1751023316921_0014
HUOMIL Transactions: 8124

====== HUOMIL: VALID ITEMS in UOList ======
+---------+---------+-----+------------------+
|StockCode|InvoiceNo|   TU|                IU|
+---------+---------+-----+------------------+
|       35|        2|406.0| 5.539942638348329|
|        4|        8|375.0| 16.41349663785086|
|        3|       19|376.0| 16.53823838832839|
|       54|       19|376.0| 5.624332341188486|
|       99|       21|312.0| 5.517938681725811|
|       12|       24|405.0|27.220252696401474|
|       85|       34|415.0| 5.464557508805685|
|      110|       38|421.0|5.4781636279162935|
|       34|       39|358.0| 5.503448465824916|
|       34|       41|330.0| 5.503448465824916|
|       40|       42|434.0| 5.483682889255451|
|        7|       50|474.0|5.4497275386026764|
|        6|       54|392.0|10.996109808584759|
|       21|       54|392.0|10.933585900644212|
|       10|       61|367.0|10.938910677985266|
|       18|       68|299.0|11.022808713017401|
|       35|       70|380.0|11.079885276696658|
|       26|       73|470.0| 5.523688653723838|
|       21|       81|298.0| 5.466792950322106|
|       26|       98|475.0| 5.523688653723838|
+---------+---------+-----+------------------+
only showing top 20 rows


====== HUOMIL: 1-ITEMSETS ======
+---------+------------------+--------------------+
|StockCode|        total_util|              avg_uo|
+---------+------------------+--------------------+
|        7|35608.519737229886|0.019401830482474618|
|       54|17429.805925343117|0.015684265586707286|
|       15| 34858.84263144213|0.019694589980530218|
|       11|12575.861039506437|0.012345183815738521|
|      101| 9002.714847535624|0.013588823407305845|
|       69|10222.933027543097|0.013482690268650656|
|       29|11862.476200649566|0.013787760456791151|
|       42|20265.266722343807|0.015518025827640785|
|      112|1917.0105152502679|0.013594785951389979|
|       73|1068.4144970307673| 0.01327654129111437|
|       87| 518.1337332267577|0.013083823273554852|
|       64| 5345.590751807149|0.013424336254825567|
|        3| 56318.21445838766| 0.02333092247408778|
|       30| 41791.84272725987|0.019729914725614254|
|      113| 2005.823370576756|0.014404252254608707|
|       34|43554.291158538326|0.013492728724939696|
|       59|28830.665629636867|0.013559884158366809|
|        8|57009.249154688645| 0.02383251574354525|
|       28| 29235.33427169244| 0.01576222857848498|
|       85| 44394.06520153741|0.013389201991593058|
+---------+------------------+--------------------+
only showing top 20 rows


HUOMIL 2-itemset candidates: 5043423

====== HUOMIL: 2-ITEMSETS (Sorted by total_util) ======
+-----+-----+------------------+--------------------+-------+
|item1|item2|total_util        |avg_uo              |itemset|
+-----+-----+------------------+--------------------+-------+
|10   |6    |153721.53875597232|0.06071605381439558 |10,6   |
|2    |6    |138581.1327299533 |0.05578792688834695 |2,6    |
|10   |2    |136788.9856498363 |0.05538227348654033 |10,2   |
|6    |85   |127759.80541942288|0.04402671668485247 |6,85   |
|10   |36   |127267.5542450079 |0.048963180750733144|10,36  |
|10   |85   |126282.1544226322 |0.043798325094188836|10,85  |
|34   |6    |125069.00532855619|0.04423332225379077 |34,6   |
|6    |86   |124990.80398877877|0.04413678896889767 |6,86   |
|36   |6    |124622.09595149441|0.04823606653805589 |36,6   |
|10   |34   |123786.11881525727|0.04399844330411901 |10,34  |
|10   |86   |123681.32003856645|0.043895135282265144|10,86  |
|6    |90   |119034.55549218394|0.044432966099491815|6,90   |
|10   |90   |118562.53854794551|0.04447364477938993 |10,90  |
|24   |6    |116856.0509103887 |0.05154824631973016 |24,6   |
|10   |24   |115588.01554476836|0.05137407033116679 |10,24  |
|10   |3    |113151.66102218682|0.05381523719679987 |10,3   |
|4    |6    |113120.37314465008|0.05419552032060632 |4,6    |
|6    |8    |112960.17420083548|0.05408873558146978 |6,8    |
|10   |8    |112959.8288838347 |0.054231393186135526|10,8   |
|10   |4    |112276.01229144444|0.054385101232140014|10,4   |
+-----+-----+------------------+--------------------+-------+
only showing top 20 rows

==================== Finished HUOMIL Application ====================

==================== Starting HUOPM Application (mushroom) ====================
25/06/27 18:37:56 WARN Client: Neither spark.yarn.jars nor spark.yarn.archive is set, falling back to uploading libraries under SPARK_HOME.
HUOPM running with Application ID: application_1751023316921_0015
HUOPM Transactions: 8124

====== HUOPM: 1-ITEMSETS ======
+---------+------------------+--------------------+
|StockCode|        total_util|              avg_uo|
+---------+------------------+--------------------+
|        7| 35608.51973722994| 0.01939673303985726|
|       54|17429.805925343113| 0.01567523720356211|
|       15|34858.842631442036|   0.019668131966413|
|       11|12575.861039506415| 0.01232713930234359|
|      101|  9002.71484753565| 0.01357280600834763|
|       69|10222.933027543095|0.013479422485670259|
|       29|11862.476200649564|0.013789491134751466|
|       42| 20265.26672234389|0.015505767201605646|
|      112|1917.0105152502636| 0.01360333228769163|
|       73|1068.4144970307661|0.013314143193157602|
|       87| 518.1337332267572|0.012978512524879396|
|       64| 5345.590751807144|0.013413259030854578|
|        3| 56318.21445838756|0.023362132342112478|
|       30| 41791.84272725991|0.019742656244521414|
|      113|2005.8233705767557|0.014249008991934176|
|       34| 43554.29115853824|0.013485397062630102|
|       59|28830.665629636867|0.013551382127759797|
|        8| 57009.24915468879|0.023809407050055555|
|       28|29235.334271692504| 0.01575079832992958|
|       85| 44394.06520153727|0.013388645196365744|
+---------+------------------+--------------------+
only showing top 20 rows


HUOPM 2-itemset candidates: 5043423

====== HUOPM: 2-ITEMSETS (Sorted by total_util) ======
+-----+-----+------------------+--------------------+-------+
|item1|item2|total_util        |avg_uo              |itemset|
+-----+-----+------------------+--------------------+-------+
|10   |6    |153764.37375853848|0.06068108168991764 |10,6   |
|2    |6    |138758.9960066278 |0.05585300906916805 |2,6    |
|10   |2    |136802.2256175549 |0.05538685650801716 |10,2   |
|6    |85   |127817.74264269309|0.044017491099443716|6,85   |
|10   |36   |127232.28486059984|0.048914059523922505|10,36  |
|10   |85   |126316.21396368695|0.04377286222298289 |10,85  |
|34   |6    |125099.78198158683|0.044207737791242076|34,6   |
|6    |86   |125055.3576915169 |0.04412351603571967 |6,86   |
|36   |6    |124626.01872433924|0.04819796767677087 |36,6   |
|10   |86   |123900.44855896923|0.043933023944957794|10,86  |
|10   |34   |123892.7937567999 |0.04399715672654786 |10,34  |
|6    |90   |118985.73350984056|0.044387259078116185|6,90   |
|10   |90   |118632.30235205287|0.04447046928147247 |10,90  |
|24   |6    |116694.80014063299|0.05144419732468109 |24,6   |
|10   |24   |115619.83213128049|0.05135175306888339 |10,24  |
|10   |3    |113101.67363511925|0.05377819614345819 |10,3   |
|10   |8    |112915.09234244672|0.05417170697234926 |10,8   |
|4    |6    |112878.08017877655|0.05409525045786606 |4,6    |
|6    |8    |112673.22441634384|0.05385907449090021 |6,8    |
|10   |4    |112619.95865353466|0.054540472056093914|10,4   |
+-----+-----+------------------+--------------------+-------+
only showing top 20 rows

==================== Finished HUOPM Application ====================

Waiting 60 seconds for History Server...
--- Fetching metrics for App ID: application_1751023316921_0014 ---
Successfully fetched metrics for app application_1751023316921_0014.
--- Fetching metrics for App ID: application_1751023316921_0015 ---
Successfully fetched metrics for app application_1751023316921_0015.


==================== FINAL mushroom COMPARISON ====================
Jaccard Similarity between 2-itemsets: 0.9986

  Algorithm  1-itemsets  2-itemsets  Execution Time (s)  Driver CPU (s)  Driver Memory (MB)  Max Executor Memory (MB)  Shuffle Read (MB)
0    HUOMIL         103        4258           33.289864            0.14           95.628906                839.384087          62.109739
1     HUOPM         103        4254           29.461385            0.14           95.640625                422.695702          63.869414

Biểu đồ đã được lưu thành công vào file: mushroom_performance_comparison.png

