(spark_env) mqang@mqang-legion-5-16ach6:~/Desktop/hadoop-3.2.1$ spark-submit --master yarn --deploy-mode client test2.py
==================== Calculating Initial Data Statistics ====================

Transaction Utility (TU) Statistics:
  summary                  TU
0   count               18532
1    mean  480.86595639974144
2  stddev  1678.1955794895207
3     min                0.38
4     max            168469.6

Note: These statistics are based on the raw transaction utility, not specific to any algorithm.
==================== Finished Initial Data Statistics ====================

==================== Starting HUOMIL Application ====================
HUOMIL running with Application ID: application_1750949443549_0002
HUOMIL Transactions: 18532

====== HUOMIL: VALID ITEMS in UOList ======
+---------+---------+------------------+------------------+
|StockCode|InvoiceNo|                TU|                IU|
+---------+---------+------------------+------------------+
|    79321|   536938|1939.8763976188402| 390.8706870229013|
|    21931|   536938|1939.8763976188402|40.577777777777946|
|    21479|   536938|1939.8763976188402| 289.3681841432225|
|    22112|   536938|1939.8763976188402|350.91831932773164|
|   84997B|   536938|1939.8763976188402| 97.06036363636336|
|    20713|   536938|1939.8763976188402| 40.38574821852723|
|   85099C|   536938|1939.8763976188402| 40.24461305007593|
|    21258|   536938|1939.8763976188402| 310.8566037735849|
|    22386|   536938|1939.8763976188402|40.372134831460855|
|    20712|   536938|1939.8763976188402|40.723943661971774|
|    22837|   536938|1939.8763976188402| 166.3411764705879|
|   84997A|   536938|1939.8763976188402| 97.94051282051261|
|    20724|   536938|1939.8763976188402|16.986151797603224|
|    22356|   536938|1939.8763976188402|17.230181086519046|
|    82486|   537691| 311.7984601745683|17.365307557117752|
|    84755|   537691| 311.7984601745683|10.374328358208988|
|    22470|   537691| 311.7984601745683|17.741025641025765|
|    22469|   537691| 311.7984601745683| 19.67390862944148|
|    22666|   537691| 311.7984601745683|17.774519572953853|
|    84580|   537691| 311.7984601745683|15.061788617886178|
+---------+---------+------------------+------------------+
only showing top 20 rows

========================================

====== HUOMIL: 1-ITEMSETS ======
+---------+------------------+-------------------+
|StockCode|        total_util|             avg_uo|
+---------+------------------+-------------------+
|    84212| 6371.143786407757|0.10480625288061447|
|    23113| 5598.959999999996|0.07631014145168226|
|    82486|18103.333128295246|0.08259716252867007|
|    23382|  6352.77268292683|0.07898055378402263|
|    84347|20604.384617736956| 0.0973443543103646|
|    21181|24795.288962131966|0.07782746610639861|
|    85066|21565.664395604363|0.10006459979439211|
|    23080| 8382.616491228053| 0.0781584870036456|
|    23284| 42273.97816793891|0.12210832983230349|
|    22526|1424.9910447761195|0.09455808581054688|
|    22797| 2493.809367088608|0.07812979066925446|
|   15058C|1225.5499999999997|0.08262501118451146|
|    22776|11003.735254988878|0.07740738067204603|
|    11001|2318.5474999999983|0.07605828357030504|
|    21621|21603.584577114405|0.13406105028414247|
|    21922| 6034.229644970422|0.10425419119835742|
|    21108|14131.688629441644|0.07579060789339374|
|    22607|12406.066416938118|0.08759301221878735|
|    22084|14224.832506527475|0.09928939957384147|
|    48116|10925.800352112687|0.09522227128105341|
+---------+------------------+-------------------+
only showing top 20 rows

==============================
HUOMIL 2-itemset candidates: 81641

====== HUOMIL: 2-ITEMSETS (Sorted by total_util) ======
+-------+------+------------------+-------------------+--------------+
|item1  |item2 |total_util        |avg_uo             |itemset       |
+-------+------+------------------+-------------------+--------------+
|21623  |82484 |34770.67996445801 |0.1899375208415572 |21623,82484   |
|23298  |47566 |32528.25546161444 |0.1361774398673512 |23298,47566   |
|20713  |85099B|29762.126621866657|0.12404267586814811|20713,85099B  |
|22423  |47566 |25637.507075800586|0.16066098654449534|22423,47566   |
|22423  |84879 |25108.239307695545|0.15483556075763835|22423,84879   |
|21137  |22041 |23397.201396097207|0.3337486897478455 |21137,22041   |
|47566  |85123A|21575.01647953769 |0.13934615311116882|47566,85123A  |
|21108  |85123A|21243.213616358313|0.13446006773664618|21108,85123A  |
|85099B |85123A|20209.615943394634|0.11207548874884726|85099B,85123A |
|21843  |22423 |19165.84344846322 |0.18131410280670368|21843,22423   |
|22423  |85123A|19152.30983173734 |0.13067764392999534|22423,85123A  |
|15056BL|15056N|18774.936967399   |0.16617320953662032|15056BL,15056N|
|84879  |85123A|18765.82004606888 |0.13135327112739775|84879,85123A  |
|23284  |48138 |18320.637868467402|0.15343818731959133|23284,48138   |
|22423  |85099B|18266.066096127608|0.11384980366929   |22423,85099B  |
|47566  |85099B|17892.263527985495|0.10756877979458718|47566,85099B  |
|48138  |48173C|16918.307421328664|0.1331072209148891 |48138,48173C  |
|22112  |23355 |16038.250194185715|0.12716341077305351|22112,23355   |
|47566  |84879 |15430.790681818216|0.16522248012755442|47566,84879   |
|22171  |82484 |14391.881854935498|0.13773440135292245|22171,82484   |
+-------+------+------------------+-------------------+--------------+
only showing top 20 rows

==================================================
==================== Finished HUOMIL Application ====================

==================== Starting HUOPM Application ====================
25/06/26 21:53:12 WARN Client: Neither spark.yarn.jars nor spark.yarn.archive is set, falling back to uploading libraries under SPARK_HOME.
HUOPM running with Application ID: application_1750949443549_0003
HUOPM Transactions: 18532

====== HUOPM: 1-ITEMSETS ======
+---------+------------------+-------------------+
|StockCode|        total_util|             avg_uo|
+---------+------------------+-------------------+
|    23113| 5695.860000000002|0.07739122920407682|
|    82486|17590.629999999997| 0.0848592929766567|
|    23382| 6155.039999999999|0.08026603506168586|
|    84347|          17592.52|0.09717274520069741|
|    21833| 4278.120000000003|0.08843885887620949|
|    23328| 7510.289999999997|0.07584133671812757|
|    21181| 23930.92000000001|0.07930896120951686|
|    85066|20562.920000000006|0.10057981182006902|
|    23284| 35913.85000000001|0.12154328273016111|
|    23080| 7962.030000000001|0.07890459766068783|
|    23065|            3115.3|0.08755053009471854|
|    23486|3879.1500000000024| 0.0873946845016708|
|    22777|2598.4500000000003| 0.1757900230099915|
|    22776|10570.600000000008|0.07868221897419482|
|    22791| 8378.889999999998|0.12937781134015194|
|    22053|3596.4199999999996|0.11654377688668513|
|    21621|          20962.16|0.13501376624232556|
|    22607|11601.140000000001|0.08746754982117427|
|    22084|13435.149999999994|0.10100887406058567|
|    48116| 8053.219999999995|0.09762481519369885|
+---------+------------------+-------------------+
only showing top 20 rows

==============================
HUOPM 2-itemset candidates: 9082243

====== HUOPM: 2-ITEMSETS (Sorted by total_util) ======
+------+------+------------------+-------------------+-------------+
|item1 |item2 |total_util        |avg_uo             |itemset      |
+------+------+------------------+-------------------+-------------+
|22386 |85099B|55123.21999999996 |0.11871147466987636|22386,85099B |
|85099B|85099F|54391.80999999996 |0.14348993266978613|85099B,85099F|
|22423 |22699 |52023.680000000124|0.16293045732437533|22423,22699  |
|21733 |85123A|44018.87000000001 |0.14270018410249358|21733,85123A |
|22423 |22697 |40116.96000000007 |0.1695520975572314 |22423,22697  |
|22469 |22470 |35255.27          |0.1122075358380986 |22469,22470  |
|22423 |22698 |34601.230000000025|0.16595813534079867|22423,22698  |
|23199 |85099B|34544.72999999999 |0.11745394973603678|23199,85099B |
|22386 |85099F|34535.86          |0.11848010580260565|22386,85099F |
|22086 |22910 |33137.079999999965|0.12847416578630788|22086,22910  |
|23203 |85099B|33024.44          |0.11038691480948194|23203,85099B |
|85099B|85099C|32778.63          |0.13724338448877893|85099B,85099C|
|21931 |85099B|32112.09000000001 |0.11504761803189012|21931,85099B |
|22470 |85123A|31945.09999999999 |0.12137562568728064|22470,85123A |
|22726 |22727 |31738.39          |0.10464651960221097|22726,22727  |
|22423 |22629 |31527.430000000008|0.11533012395035377|22423,22629  |
|22697 |22699 |31403.11999999993 |0.10442024860991027|22697,22699  |
|23298 |47566 |30790.199999999975|0.13794258776870919|23298,47566  |
|21929 |85099B|30070.60000000002 |0.11156585961667415|21929,85099B |
|22469 |85123A|29835.190000000006|0.11755772750105477|22469,85123A |
+------+------+------------------+-------------------+-------------+
only showing top 20 rows

==================================================
==================== Finished HUOPM Application ====================

Waiting 60 seconds for History Server to process application logs...
--- Fetching metrics for App ID: application_1750949443549_0002 ---
Found 2 non-driver executors. Analyzing peak memory.
Successfully fetched metrics for app application_1750949443549_0002. Max executor memory: 750.64 MB
--- Fetching metrics for App ID: application_1750949443549_0003 ---
Found 2 non-driver executors. Analyzing peak memory.
Successfully fetched metrics for app application_1750949443549_0003. Max executor memory: 793.86 MB


==================== FINAL COMPARISON ====================
Jaccard Similarity between 2-itemsets: 0.0935

  Algorithm  1-itemsets  2-itemsets  Execution Time (s)  Driver CPU (s)  Driver Memory (MB)  Max Executor Memory (MB)  Shuffle Read (MB)
0    HUOMIL         251        1907           56.860451            0.23           94.964844                750.639816          73.072682
1     HUOPM         248       19178           41.554465            0.12           99.269531                793.855713         232.992644

Biểu đồ đã được lưu thành công vào file: performance_comparison.png

